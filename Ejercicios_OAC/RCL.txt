%include "./pc_io.inc" 

section .data
msg: db 'ingrese una cadena : ',0x0
msg2 db 'ingrese el numero de corrimientos: ',0x0
len: equ $- msg

section .bss
cadena resb 50
corry resb 10
cad resb 10

section .text

global _start
_start:

mov edx, msg
call puts

mov edx,cadena

call capturar
call salto

call capturacorrimiento
call salto

;mov al,byte[corry]           ;verificar el contenido de corry
;call putchar
;call salto


call corrimiento

call mostrar
call salto



mov eax,1
mov ebx,0
int 80h



capturar: 
    pushad
    mov esi,0

    ciclocap:
        call getche
        mov byte[edx+esi],al
        cmp esi,7
        je fin1
        inc esi
        jmp ciclocap
    fin1 : 
        popad
        ret

capturacorrimiento:pushad
    mov edx,msg2
    call puts
    call getche
    mov byte[corry],al
    popad
    ret
    
corrimiento:pushad
    mov edx,cadena
    mov esi,0
    ;mov edi,7
    movzx ecx,byte[corry]              ;cl =2
    ;inc ecx
    
    ciclocorrimiento:

    


    mov ah,byte[edx]
    sub ah,'0'
    SAHF
    LAHF 
    and ah,01h
    add ah,'0'
    push ax
    mov esi,1
    pushad

        ciclocorrimiento2:
        
        mov al,byte[edx+esi]
        ;sub al,'0'
        dec esi
        mov byte[edx+esi],al
        add esi,2
        cmp esi,8
        je salto2
        jmp ciclocorrimiento2

        

        salto2:
        mov edi,7
        mov byte[edx+edi],ah
        popad
        pop ax
        loop ciclocorrimiento

    

popad
ret

mostrar:pushad
    mov edx,cadena
    mov esi,0
     
    ciclomostrar:
    mov al,byte[edx+esi]
    cmp esi,8
    je fin2
    call putchar
    inc esi
    jmp ciclomostrar

    fin2:
    popad
    ret

    

salto:
    pushad
    mov al,13
    call putchar
    mov al,10
    call putchar
    popad
    ret

